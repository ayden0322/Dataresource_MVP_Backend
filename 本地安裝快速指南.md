# æœ¬åœ°å®‰è£å¿«é€ŸæŒ‡å—ï¼ˆç„¡éœ€ Dockerï¼‰

> é©ç”¨æ–¼ CPU ä¸æ”¯æ´è™›æ“¬åŒ–æˆ–ç„¡æ³•å®‰è£ Docker çš„é–‹ç™¼ç’°å¢ƒ

## ğŸ“‹ ç›®éŒ„

- [å¿«é€Ÿé–‹å§‹](#å¿«é€Ÿé–‹å§‹)
- [è©³ç´°æ­¥é©Ÿ](#è©³ç´°æ­¥é©Ÿ)
- [æœå‹™ç®¡ç†](#æœå‹™ç®¡ç†)
- [é€£ç·šè³‡è¨Š](#é€£ç·šè³‡è¨Š)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ä¸€éµå®‰è£

åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„åŸ·è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
# 1. å®‰è£ PostgreSQL
.\setup-scripts\06-setup-local-postgresql.ps1

# 2. å®‰è£ MinIO
.\setup-scripts\07-setup-local-minio.ps1
```

### é©—è­‰å®‰è£

```powershell
# æª¢æŸ¥ PostgreSQL
Get-Service -Name postgresql*

# æª¢æŸ¥ MinIO
Get-Process minio -ErrorAction SilentlyContinue

# æ¸¬è©¦ PostgreSQL é€£ç·š
psql -U admin -d vendor_assessment -h localhost

# è¨ªå• MinIO æ§åˆ¶å°
# é–‹å•Ÿç€è¦½å™¨ï¼šhttp://localhost:9001
```

---

## ğŸ“ è©³ç´°æ­¥é©Ÿ

### æ­¥é©Ÿ 1ï¼šå»ºç«‹å°ˆæ¡ˆçµæ§‹

```powershell
# åŸ·è¡ŒåŸºç¤è¨­å®šè…³æœ¬
.\setup-scripts\01-create-structure.ps1
.\setup-scripts\02-init-workspace.ps1
.\setup-scripts\03-setup-shared.ps1
.\setup-scripts\05-create-env-files.ps1
```

### æ­¥é©Ÿ 2ï¼šå®‰è£ PostgreSQL

åŸ·è¡Œå®‰è£è…³æœ¬ï¼Œè…³æœ¬æœƒè‡ªå‹•å¼•å°æ‚¨ï¼š

```powershell
.\setup-scripts\06-setup-local-postgresql.ps1
```

å®‰è£é¸é …ï¼š
1. **ä½¿ç”¨ Chocolatey è‡ªå‹•å®‰è£**ï¼ˆæ¨è–¦ï¼Œéœ€ç®¡ç†å“¡æ¬Šé™ï¼‰
2. **æ‰‹å‹•ä¸‹è¼‰å®‰è£ç¨‹å¼**
3. **ä½¿ç”¨é›²ç«¯æœå‹™**ï¼ˆSupabase/Neon/ElephantSQLï¼‰

### æ­¥é©Ÿ 3ï¼šå®‰è£ MinIO

```powershell
.\setup-scripts\07-setup-local-minio.ps1
```

è…³æœ¬æœƒï¼š
- ä¸‹è¼‰ MinIO åŸ·è¡Œæª”åˆ° `C:\minio`
- å»ºç«‹å•Ÿå‹•/åœæ­¢è…³æœ¬
- è©¢å•æ˜¯å¦è¨­å®šç‚º Windows æœå‹™

### æ­¥é©Ÿ 4ï¼šå•Ÿå‹•æœå‹™

**PostgreSQL**ï¼ˆé€šå¸¸è‡ªå‹•å•Ÿå‹•ï¼‰
```powershell
# æª¢æŸ¥ç‹€æ…‹
Get-Service -Name postgresql*

# å¦‚æœªå•Ÿå‹•ï¼Œæ‰‹å‹•å•Ÿå‹•
Start-Service postgresql-x64-18
```

**MinIO**
```powershell
# æ–¹å¼ 1ï¼šä½¿ç”¨æ‰¹æ¬¡æª”
C:\minio\start-minio.bat

# æ–¹å¼ 2ï¼šä½¿ç”¨ PowerShell
C:\minio\start-minio.ps1

# æ–¹å¼ 3ï¼šå¦‚å·²è¨­å®šç‚ºæœå‹™
Start-Service MinIO
```

### æ­¥é©Ÿ 5ï¼šå•Ÿå‹•æ‡‰ç”¨ç¨‹å¼

```powershell
# å®‰è£ä¾è³´
pnpm install

# å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨
pnpm dev

# æˆ–åˆ†åˆ¥å•Ÿå‹•
pnpm dev:backend  # http://localhost:3000
pnpm dev:frontend # http://localhost:3001
```

---

## ğŸ”§ æœå‹™ç®¡ç†

### PostgreSQL ç®¡ç†

```powershell
# æª¢æŸ¥ç‹€æ…‹
Get-Service -Name postgresql*

# å•Ÿå‹•æœå‹™
Start-Service postgresql-x64-18

# åœæ­¢æœå‹™
Stop-Service postgresql-x64-18

# é‡æ–°å•Ÿå‹•
Restart-Service postgresql-x64-18

# é€£ç·šåˆ°è³‡æ–™åº«
psql -U admin -d vendor_assessment -h localhost

# åŸ·è¡Œ SQL æŒ‡ä»¤
psql -U admin -d vendor_assessment -h localhost -c "SELECT version();"
```

### MinIO ç®¡ç†

```powershell
# å•Ÿå‹•ï¼ˆæ‰¹æ¬¡æª”ï¼‰
C:\minio\start-minio.bat

# å•Ÿå‹•ï¼ˆPowerShellï¼‰
C:\minio\start-minio.ps1

# åœæ­¢
C:\minio\stop-minio.bat
# æˆ–åœ¨é‹è¡Œè¦–çª—æŒ‰ Ctrl+C

# å¦‚æœè¨­å®šç‚ºæœå‹™
Start-Service MinIO
Stop-Service MinIO
Get-Service MinIO
```

### é–‹æ©Ÿè‡ªå‹•å•Ÿå‹•

**PostgreSQL**
- é è¨­å·²è¨­å®šç‚ºé–‹æ©Ÿè‡ªå‹•å•Ÿå‹•

**MinIO**
```powershell
# æ–¹å¼ 1ï¼šä½¿ç”¨ NSSMï¼ˆåœ¨å®‰è£æ™‚é¸æ“‡ï¼‰
# å·²è‡ªå‹•è¨­å®šç‚ºé–‹æ©Ÿå•Ÿå‹•

# æ–¹å¼ 2ï¼šä½¿ç”¨å·¥ä½œæ’ç¨‹å™¨
# é–‹å•Ÿã€Œå·¥ä½œæ’ç¨‹å™¨ã€â†’ å»ºç«‹åŸºæœ¬å·¥ä½œ
# è§¸ç™¼ç¨‹åºï¼šé›»è…¦å•Ÿå‹•æ™‚
# å‹•ä½œï¼šå•Ÿå‹•ç¨‹å¼ C:\minio\start-minio.bat
```

---

## ğŸ”— é€£ç·šè³‡è¨Š

### PostgreSQL

| é …ç›® | å€¼ |
|------|-----|
| ä¸»æ©Ÿ | `localhost` |
| é€£æ¥åŸ  | `5432` |
| è³‡æ–™åº« | `vendor_assessment` |
| ä½¿ç”¨è€… | `admin` |
| å¯†ç¢¼ | `password123` |
| é€£ç·šå­—ä¸² | `postgresql://admin:password123@localhost:5432/vendor_assessment` |

### MinIO

| é …ç›® | å€¼ |
|------|-----|
| API ç«¯é» | `http://localhost:9000` |
| æ§åˆ¶å° | `http://localhost:9001` |
| Access Key | `minioadmin` |
| Secret Key | `minioadmin123` |
| Bucket | `uploads` |

### ç’°å¢ƒè®Šæ•¸æª”æ¡ˆ

é€£ç·šè³‡è¨Šå·²é è¨­åœ¨ç’°å¢ƒè®Šæ•¸æª”æ¡ˆä¸­ï¼š
- `apps/backend/.env`
- `apps/frontend/.env.local`

**ç„¡éœ€ä¿®æ”¹**ï¼Œç›´æ¥ä½¿ç”¨å³å¯ï¼

---

## ğŸ†˜ æ•…éšœæ’é™¤

### PostgreSQL ç„¡æ³•é€£ç·š

**ç—‡ç‹€**ï¼š`psql: error: connection refused`

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
```powershell
# 1. æª¢æŸ¥æœå‹™ç‹€æ…‹
Get-Service -Name postgresql*

# 2. å•Ÿå‹•æœå‹™
Start-Service postgresql-x64-18

# 3. æª¢æŸ¥é€£æ¥åŸ 
netstat -ano | findstr "5432"

# 4. æª¢æŸ¥é˜²ç«ç‰†
# æ§åˆ¶å° â†’ Windows Defender é˜²ç«ç‰† â†’ é€²éšè¨­å®š
# ç¢ºèª PostgreSQL è¦å‰‡å·²å•Ÿç”¨

# 5. æŸ¥çœ‹æ—¥èªŒ
# é è¨­ä½ç½®ï¼šC:\Program Files\PostgreSQL\18\data\log
```

### MinIO ç„¡æ³•å•Ÿå‹•

**ç—‡ç‹€**ï¼šé€£æ¥åŸ è¢«å ç”¨æˆ–ç„¡æ³•å­˜å–

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
```powershell
# 1. æª¢æŸ¥ MinIO æ˜¯å¦å·²åœ¨é‹è¡Œ
Get-Process minio -ErrorAction SilentlyContinue

# 2. æª¢æŸ¥é€£æ¥åŸ æ˜¯å¦è¢«å ç”¨
netstat -ano | findstr "9000"
netstat -ano | findstr "9001"

# 3. çµ‚æ­¢ä½”ç”¨çš„é€²ç¨‹ï¼ˆè«‹å…ˆç¢ºèªï¼‰
# taskkill /PID <é€²ç¨‹ID> /F

# 4. é‡æ–°å•Ÿå‹• MinIO
C:\minio\start-minio.bat

# 5. æª¢æŸ¥é˜²ç«ç‰†è¨­å®š
```

### è³‡æ–™åº«é·ç§»å¤±æ•—

**ç—‡ç‹€**ï¼š`TypeORM migration failed`

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
```powershell
# 1. ç¢ºèª PostgreSQL æ­£åœ¨é‹è¡Œ
Get-Service -Name postgresql*

# 2. æ¸¬è©¦é€£ç·š
psql -U admin -d vendor_assessment -h localhost

# 3. æª¢æŸ¥ç’°å¢ƒè®Šæ•¸
cat apps\backend\.env

# 4. æ‰‹å‹•åŸ·è¡Œé·ç§»
cd apps/backend
pnpm run migration:run
```

### å¾Œç«¯ç„¡æ³•é€£æ¥ MinIO

**ç—‡ç‹€**ï¼š`Error: connect ECONNREFUSED 127.0.0.1:9000`

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
```powershell
# 1. ç¢ºèª MinIO æ­£åœ¨é‹è¡Œ
Get-Process minio -ErrorAction SilentlyContinue

# 2. æ¸¬è©¦ MinIO API
curl http://localhost:9000/minio/health/live

# 3. è¨ªå•æ§åˆ¶å°ç¢ºèª
# é–‹å•Ÿï¼šhttp://localhost:9001
# ç™»å…¥ï¼šminioadmin / minioadmin123

# 4. æª¢æŸ¥ç’°å¢ƒè®Šæ•¸
# apps/backend/.env
MINIO_ENDPOINT=localhost
MINIO_PORT=9000
MINIO_USE_SSL=false
```

### æ‰¾ä¸åˆ° psql å‘½ä»¤

**ç—‡ç‹€**ï¼š`psql: command not found`

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
```powershell
# 1. æ‰¾åˆ° PostgreSQL å®‰è£è·¯å¾‘
Get-Command psql -ErrorAction SilentlyContinue

# 2. æ‰‹å‹•åŠ å…¥ PATH
$env:PATH += ";C:\Program Files\PostgreSQL\18\bin"

# 3. æ°¸ä¹…åŠ å…¥ PATHï¼ˆç³»çµ±ç’°å¢ƒè®Šæ•¸ï¼‰
# æ§åˆ¶å° â†’ ç³»çµ± â†’ é€²éšç³»çµ±è¨­å®š â†’ ç’°å¢ƒè®Šæ•¸
# ç·¨è¼¯ Pathï¼ŒåŠ å…¥ï¼šC:\Program Files\PostgreSQL\18\bin
```

---

## ğŸ“š å»¶ä¼¸é–±è®€

### è©³ç´°æ–‡ä»¶

- **`setup-scripts/06-install-local-services.md`**
  å®Œæ•´çš„å®‰è£æŒ‡å—ï¼ŒåŒ…å«æ‰‹å‹•å®‰è£æ­¥é©Ÿ

- **`setup-scripts/README.md`**
  æ‰€æœ‰è¨­å®šè…³æœ¬èªªæ˜

- **`MVPå°ˆæ¡ˆåŸ·è¡Œæ–‡ä»¶.md`**
  å®Œæ•´çš„é–‹ç™¼æŒ‡å—

### ç®¡ç†å·¥å…·

**PostgreSQL ç®¡ç†å·¥å…·**
- [pgAdmin](https://www.pgadmin.org/) - å®˜æ–¹åœ–å½¢åŒ–ç®¡ç†å·¥å…·
- [DBeaver](https://dbeaver.io/) - é€šç”¨è³‡æ–™åº«ç®¡ç†å·¥å…·

**MinIO ç®¡ç†**
- MinIO Console: http://localhost:9001
- [MinIO Client (mc)](https://min.io/docs/minio/windows/reference/minio-mc.html) - å‘½ä»¤åˆ—å·¥å…·

---

## âœ… æª¢æŸ¥æ¸…å–®

å®‰è£å®Œæˆå¾Œï¼Œè«‹ç¢ºèªï¼š

- [ ] PostgreSQL æœå‹™å·²å•Ÿå‹•
- [ ] å¯ä»¥ä½¿ç”¨ `psql` é€£ç·šåˆ°è³‡æ–™åº«
- [ ] è³‡æ–™åº« `vendor_assessment` å·²å»ºç«‹
- [ ] ä½¿ç”¨è€… `admin` å¯ä»¥å­˜å–
- [ ] MinIO å·²å•Ÿå‹•ï¼ˆå¯å­˜å–æ§åˆ¶å°ï¼‰
- [ ] å¯ä»¥å­˜å– http://localhost:9001
- [ ] ä½¿ç”¨ `minioadmin` å¯ä»¥ç™»å…¥
- [ ] ç’°å¢ƒè®Šæ•¸æª”æ¡ˆ `.env` å·²å»ºç«‹
- [ ] `pnpm install` åŸ·è¡ŒæˆåŠŸ
- [ ] `pnpm dev` å¯ä»¥å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼

---

## ğŸ’¡ æç¤º

### é–‹ç™¼æµç¨‹

```powershell
# æ¯å¤©é–‹ç™¼å‰
# 1. ç¢ºèªæœå‹™é‹è¡Œ
Get-Service postgresql*
Get-Process minio

# 2. å¦‚æœªé‹è¡Œï¼Œå•Ÿå‹•æœå‹™
Start-Service postgresql-x64-18
C:\minio\start-minio.bat

# 3. å•Ÿå‹•æ‡‰ç”¨
pnpm dev
```

### èˆ‡ Docker æ–¹æ¡ˆçš„å·®ç•°

| é …ç›® | Docker æ–¹æ¡ˆ | æœ¬åœ°å®‰è£æ–¹æ¡ˆ |
|------|------------|-------------|
| è™›æ“¬åŒ–éœ€æ±‚ | âœ… éœ€è¦ | âŒ ä¸éœ€è¦ |
| å®‰è£è¤‡é›œåº¦ | ç°¡å–®ï¼ˆä¸€éµå•Ÿå‹•ï¼‰ | ä¸­ç­‰ï¼ˆéœ€é€æ­¥å®‰è£ï¼‰ |
| è³‡æºä½”ç”¨ | è¼ƒé«˜ | è¼ƒä½ |
| å•Ÿå‹•é€Ÿåº¦ | è¼ƒæ…¢ | è¼ƒå¿« |
| é€£ç·šè³‡è¨Š | ç›¸åŒ | ç›¸åŒ |
| ç®¡ç†æ–¹å¼ | docker-compose | Windows æœå‹™ |
| é©ç”¨ç’°å¢ƒ | é–‹ç™¼/æ¸¬è©¦ | é–‹ç™¼/æ¸¬è©¦/ç”Ÿç”¢ |

### å„ªå‹¢

âœ… **ç„¡éœ€è™›æ“¬åŒ–**ï¼šèˆŠé›»è…¦æˆ–ä¸æ”¯æ´çš„ CPU ä¹Ÿèƒ½é–‹ç™¼  
âœ… **æ›´è¼•é‡**ï¼šç›´æ¥é‹è¡Œï¼Œç„¡éœ€å®¹å™¨é–‹éŠ·  
âœ… **æ›´å¿«é€Ÿ**ï¼šæœå‹™å•Ÿå‹•æ›´å¿«  
âœ… **æ˜“æ–¼ç®¡ç†**ï¼šä½¿ç”¨ Windows æœå‹™ç®¡ç†  
âœ… **ç›¸å®¹æ€§ä½³**ï¼šèˆ‡ Docker æ–¹æ¡ˆé…ç½®å®Œå…¨ç›¸åŒ

---

**å»ºç«‹æ—¥æœŸ**: 2025-10-27  
**æœ€å¾Œæ›´æ–°**: 2025-10-27  
**ç¶­è­·è€…**: é–‹ç™¼åœ˜éšŠ

